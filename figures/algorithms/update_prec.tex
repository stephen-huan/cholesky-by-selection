\begin{algorithmic}[1]
  \REQUIRE \(
    X = \begin{pmatrix} X_\Train \\ X_\Pred \end{pmatrix},
    \K(\cdot, \cdot), \I, \CM_{:, : \mid \I}, \CM_{\I, \I}^{-1}, k
  \)
  % \ENSURE \( \I \)

  \STATE \( \I \gets \I \cup \{ k \} \)
  \STATE \( \vec{v} \gets \CM_{\I, \I}^{-1}
    \K(X_{\I \setminus \{ k \}}, X_k) \)
  \STATE \(
    \CM_{\I, \I}^{-1} \gets
    \begin{pmatrix}
      \CM_{\I, \I}^{-1} + \vec{v} \vec{v}^{\top}/\CM_{k, k \mid \I} &
      -\vec{v}/\CM_{k, k \mid \I} \\
      -\vec{v}^{\top}/\CM_{k, k \mid \I} &
      1/\CM_{k, k \mid \I}
    \end{pmatrix}
  \)
  \STATE \( \CM_{:, k} \gets \K(X, X_k) \)
  \STATE \(
    \CM_{:, k \mid \I} \gets \CM_{:, k} -
    \K(X, X_{\I \setminus \{ k \}}) \vec{v}
  \)
  \STATE \(
    \vec{u} \gets \frac{\CM_{:, k \mid \I}}{\sqrt{\CM_{k, k \mid \I}}}
  \)
  \FOR{\( j \in \Train \setminus \I \)}
    \STATE \(
      \CM_{j, j \mid I} \gets
      \CM_{j, j \mid \I} -
      \vec{u}_j^2
    \)
    \STATE \(
      \CM_{j, \Pred \mid \I} \gets
      \CM_{j, \Pred \mid \I} -
      \vec{u}_j \vec{u}_{N + 1}
    \)
  \ENDFOR
\end{algorithmic}
